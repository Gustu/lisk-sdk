{
	"title": "Invalid block processing",
	"summary": "An invalid block with a second signature registration transaction for an already second signature account",
	"config": "mainnet",
	"runner": "block_processing_second_signature",
	"handler": "invalid_block_processing_second_signature_for_already_registered",
	"testCases": {
		"initialState": {
			"chain": [
				{
					"version": 1,
					"totalAmount": "5500000000",
					"totalFee": "10000000",
					"reward": "0",
					"timestamp": 10,
					"numberOfTransactions": 1,
					"payloadLength": 117,
					"previousBlock": "14267700672246591925",
					"generatorPublicKey": "6fdfafcd8206c179d351baac5dc104a5ff46453e9d7f27f3e28ef38fc93d7799",
					"transactions": [
						{
							"id": "4894480260259209937",
							"amount": "5500000000",
							"type": 0,
							"timestamp": 102702700,
							"senderPublicKey": "d13a2659f908146f099da29216a18fd7f845b4e1455087b1a4bced79b6fefadf",
							"senderId": "11036225455433466506L",
							"recipientId": "7917418729031818208L",
							"fee": "10000000",
							"signature": "0e2e873df154f720da151a032dd467a58918e2ea088479a8ee59d729299424e3fa1d2bb0561c66459adf851e2a718cda4d9a045ff6a6e697ac07ed853bb8cc02",
							"signatures": [],
							"asset": {}
						}
					],
					"payloadHash": "d162e958ddafec432ee440cc021eaa6f0e4737142387a65313581c2b0c21cf3d",
					"blockSignature": "93ce29fbb003b7d0144e4c4113afa4e381d0707cc3cec53b92b65e1e63396c454e81d314198a3995fe2b10525b73c96095efb8120e76aa8bba43d4acde955c0c",
					"height": 2
				},
				{
					"version": 1,
					"totalAmount": "0",
					"totalFee": "500000000",
					"reward": "0",
					"timestamp": 20,
					"numberOfTransactions": 1,
					"payloadLength": 149,
					"generatorPublicKey": "6fdfafcd8206c179d351baac5dc104a5ff46453e9d7f27f3e28ef38fc93d7799",
					"transactions": [
						{
							"id": "8782800832285320727",
							"amount": "0",
							"type": 1,
							"timestamp": 102702700,
							"senderPublicKey": "6fdfafcd8206c179d351baac5dc104a5ff46453e9d7f27f3e28ef38fc93d7799",
							"senderId": "7917418729031818208L",
							"recipientId": "",
							"fee": "500000000",
							"signature": "58a39bcab4edb64f10dff6fea60fc8b7e489245df492838c1780c576205b1f0fcc6f4d6a7ad247d81e9602ca6b71568e6131b40382a39c3823acb3a79b22d804",
							"signatures": [],
							"asset": {
								"signature": {
									"publicKey": "62e4d09ce3fa571fb4b073fb229f5ff18b6108ca89357924db887a409f61542c"
								}
							}
						}
					],
					"payloadHash": "17265fddd2c6e279f301b799b99a2055ae4c331ef82354aa2069528158e6f76b",
					"blockSignature": "489b2a8cd0e49ba16986460e8f50d0f3eeae374f2241b1204adcd29f0fe554d84f2948558f97d7b84b9b8d4f0a78f82ff4234a53119089cf8185b8131a955102",
					"height": 3
				}
			],
			"accounts": [
				{
					"address": "11036225455433466506L",
					"publicKey": "d13a2659f908146f099da29216a18fd7f845b4e1455087b1a4bced79b6fefadf",
					"balance": 994500000000,
					"secondSignature": 0,
					"isDelegate": 0,
					"vote": "0",
					"multimin": 0,
					"multilifetime": 0,
					"nameexist": 0,
					"producedBlocks": 0,
					"missedBlocks": 0,
					"fees": "0",
					"rewards": "0",
					"asset": {},
					"voteWeight": "0"
				},
				{
					"username": "genesis_100",
					"isDelegate": 1,
					"secondSignature": 0,
					"address": "7917418729031818208L",
					"publicKey": "6fdfafcd8206c179d351baac5dc104a5ff46453e9d7f27f3e28ef38fc93d7799",
					"balance": 5000000000,
					"vote": "0",
					"multimin": 0,
					"multilifetime": 0,
					"nameexist": 0,
					"producedBlocks": 0,
					"missedBlocks": 0,
					"fees": "0",
					"rewards": "0",
					"asset": {},
					"voteWeight": "1000000000000",
					"secondPublicKey": "62e4d09ce3fa571fb4b073fb229f5ff18b6108ca89357924db887a409f61542c"
				}
			]
		},
		"input": {
			"blockWithNewSecondSignatureNewRegistration": {
				"version": 1,
				"totalAmount": "0",
				"totalFee": "500000000",
				"reward": "0",
				"timestamp": 20,
				"numberOfTransactions": 1,
				"payloadLength": 149,
				"generatorPublicKey": "6fdfafcd8206c179d351baac5dc104a5ff46453e9d7f27f3e28ef38fc93d7799",
				"transactions": [
					{
						"id": "8782800832285320727",
						"amount": "0",
						"type": 1,
						"timestamp": 102702700,
						"senderPublicKey": "6fdfafcd8206c179d351baac5dc104a5ff46453e9d7f27f3e28ef38fc93d7799",
						"senderId": "7917418729031818208L",
						"recipientId": "",
						"fee": "500000000",
						"signature": "58a39bcab4edb64f10dff6fea60fc8b7e489245df492838c1780c576205b1f0fcc6f4d6a7ad247d81e9602ca6b71568e6131b40382a39c3823acb3a79b22d804",
						"signatures": [],
						"asset": {
							"signature": {
								"publicKey": "62e4d09ce3fa571fb4b073fb229f5ff18b6108ca89357924db887a409f61542c"
							}
						}
					}
				],
				"payloadHash": "17265fddd2c6e279f301b799b99a2055ae4c331ef82354aa2069528158e6f76b",
				"blockSignature": "489b2a8cd0e49ba16986460e8f50d0f3eeae374f2241b1204adcd29f0fe554d84f2948558f97d7b84b9b8d4f0a78f82ff4234a53119089cf8185b8131a955102",
				"height": 3
			}
		},
		"output": {
			"chain": [
				{
					"version": 1,
					"totalAmount": "5500000000",
					"totalFee": "10000000",
					"reward": "0",
					"timestamp": 10,
					"numberOfTransactions": 1,
					"payloadLength": 117,
					"previousBlock": "14267700672246591925",
					"generatorPublicKey": "6fdfafcd8206c179d351baac5dc104a5ff46453e9d7f27f3e28ef38fc93d7799",
					"transactions": [
						{
							"id": "4894480260259209937",
							"amount": "5500000000",
							"type": 0,
							"timestamp": 102702700,
							"senderPublicKey": "d13a2659f908146f099da29216a18fd7f845b4e1455087b1a4bced79b6fefadf",
							"senderId": "11036225455433466506L",
							"recipientId": "7917418729031818208L",
							"fee": "10000000",
							"signature": "0e2e873df154f720da151a032dd467a58918e2ea088479a8ee59d729299424e3fa1d2bb0561c66459adf851e2a718cda4d9a045ff6a6e697ac07ed853bb8cc02",
							"signatures": [],
							"asset": {}
						}
					],
					"payloadHash": "d162e958ddafec432ee440cc021eaa6f0e4737142387a65313581c2b0c21cf3d",
					"blockSignature": "93ce29fbb003b7d0144e4c4113afa4e381d0707cc3cec53b92b65e1e63396c454e81d314198a3995fe2b10525b73c96095efb8120e76aa8bba43d4acde955c0c",
					"height": 2
				},
				{
					"version": 1,
					"totalAmount": "0",
					"totalFee": "500000000",
					"reward": "0",
					"timestamp": 20,
					"numberOfTransactions": 1,
					"payloadLength": 149,
					"generatorPublicKey": "6fdfafcd8206c179d351baac5dc104a5ff46453e9d7f27f3e28ef38fc93d7799",
					"transactions": [
						{
							"id": "8782800832285320727",
							"amount": "0",
							"type": 1,
							"timestamp": 102702700,
							"senderPublicKey": "6fdfafcd8206c179d351baac5dc104a5ff46453e9d7f27f3e28ef38fc93d7799",
							"senderId": "7917418729031818208L",
							"recipientId": "",
							"fee": "500000000",
							"signature": "58a39bcab4edb64f10dff6fea60fc8b7e489245df492838c1780c576205b1f0fcc6f4d6a7ad247d81e9602ca6b71568e6131b40382a39c3823acb3a79b22d804",
							"signatures": [],
							"asset": {
								"signature": {
									"publicKey": "62e4d09ce3fa571fb4b073fb229f5ff18b6108ca89357924db887a409f61542c"
								}
							}
						}
					],
					"payloadHash": "17265fddd2c6e279f301b799b99a2055ae4c331ef82354aa2069528158e6f76b",
					"blockSignature": "489b2a8cd0e49ba16986460e8f50d0f3eeae374f2241b1204adcd29f0fe554d84f2948558f97d7b84b9b8d4f0a78f82ff4234a53119089cf8185b8131a955102",
					"height": 3
				}
			],
			"accounts": [
				{
					"address": "11036225455433466506L",
					"publicKey": "d13a2659f908146f099da29216a18fd7f845b4e1455087b1a4bced79b6fefadf",
					"balance": 994500000000,
					"secondSignature": 0,
					"isDelegate": 0,
					"vote": "0",
					"multimin": 0,
					"multilifetime": 0,
					"nameexist": 0,
					"producedBlocks": 0,
					"missedBlocks": 0,
					"fees": "0",
					"rewards": "0",
					"asset": {},
					"voteWeight": "0"
				},
				{
					"username": "genesis_100",
					"isDelegate": 1,
					"secondSignature": 0,
					"address": "7917418729031818208L",
					"publicKey": "6fdfafcd8206c179d351baac5dc104a5ff46453e9d7f27f3e28ef38fc93d7799",
					"balance": 5000000000,
					"vote": "0",
					"multimin": 0,
					"multilifetime": 0,
					"nameexist": 0,
					"producedBlocks": 0,
					"missedBlocks": 0,
					"fees": "0",
					"rewards": "0",
					"asset": {},
					"voteWeight": "1000000000000",
					"secondPublicKey": "62e4d09ce3fa571fb4b073fb229f5ff18b6108ca89357924db887a409f61542c"
				}
			]
		}
	}
}
