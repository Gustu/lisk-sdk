{
	"title": "Invalid block processing",
	"summary": "An invalid block with a second signature registration transaction for an already second signature account",
	"config": "mainnet",
	"runner": "block_processing_second_signature",
	"handler": "invalid_block_processing_second_signature_for_already_registered",
	"testCases": {
		"initialState": {
			"chain": [
				{
					"version": 1,
					"totalAmount": "5500000000",
					"totalFee": "10000000",
					"reward": "0",
					"timestamp": 10,
					"numberOfTransactions": 1,
					"payloadLength": 117,
					"previousBlock": "3110763447174287315",
					"generatorPublicKey": "f834a69d7f017b649859ea85f0a0c649202a8fb4619afa96daed06fa5641746b",
					"transactions": [
						{
							"id": "18302556673844952853",
							"amount": "5500000000",
							"type": 0,
							"timestamp": 102702700,
							"senderPublicKey": "0b3dc5a506e312bac462afc4fb34cdc3b19d1976a279930d15ae3c3516edd188",
							"senderId": "12451387766827060593L",
							"recipientId": "4103804705971278554L",
							"fee": "10000000",
							"signature": "3a4912e95376821f6739c71e58fe10e69f3492460228233f9e84b017fa2b7f4296cb975f8f431b8b2e7fdf23d074825044dcaadd28c2c2633a3e475e1a27640f",
							"signatures": [],
							"asset": {}
						}
					],
					"payloadHash": "15bffbe152befffdc87fe0ca16ba40fe12be4ed91dbebaeb21315bcf5e4fe087",
					"blockSignature": "41c969589a7fb7e99f17bb60490bbb792a1eabdeba2185306c873210697b58acb452789dcfa7dd5a919b887b58d75b77c3ee9aa838365f1ef9d2d2e9fce66b0e",
					"height": 2
				},
				{
					"version": 1,
					"totalAmount": "0",
					"totalFee": "500000000",
					"reward": "0",
					"timestamp": 20,
					"numberOfTransactions": 1,
					"payloadLength": 149,
					"generatorPublicKey": "f834a69d7f017b649859ea85f0a0c649202a8fb4619afa96daed06fa5641746b",
					"transactions": [
						{
							"id": "3613932868772923380",
							"amount": "0",
							"type": 1,
							"timestamp": 102702700,
							"senderPublicKey": "f834a69d7f017b649859ea85f0a0c649202a8fb4619afa96daed06fa5641746b",
							"senderId": "4103804705971278554L",
							"recipientId": "",
							"fee": "500000000",
							"signature": "abd99fb3c9f1140f7db4cf73b960c20efab2df047b040807132cb5d899a9748c1d7853bae571af781025f4e3d7132fd02ece01e163e900533d57da094b5a200c",
							"signatures": [],
							"asset": {
								"signature": {
									"publicKey": "62e4d09ce3fa571fb4b073fb229f5ff18b6108ca89357924db887a409f61542c"
								}
							}
						}
					],
					"payloadHash": "f48751f5cb4427328c126f60da342b8a635b8e56aa6a385c6cf0a4772ce400e8",
					"blockSignature": "ff23fe8f300ad394328178dbbbb866a6d52c5dda9f32405e518cdab92f8f807aa832224e5a26db7c723996b01f8db213befeab4c1077b1a43f1a1ade3cca370d",
					"height": 3
				}
			],
			"accounts": [
				{
					"address": "12451387766827060593L",
					"publicKey": "0b3dc5a506e312bac462afc4fb34cdc3b19d1976a279930d15ae3c3516edd188",
					"balance": 994500000000,
					"secondSignature": 0,
					"isDelegate": 0,
					"vote": "0",
					"multimin": 0,
					"multilifetime": 0,
					"nameexist": 0,
					"producedBlocks": 0,
					"missedBlocks": 0,
					"fees": "0",
					"rewards": "0",
					"asset": {},
					"voteWeight": "0"
				},
				{
					"username": "genesis_100",
					"isDelegate": 1,
					"secondSignature": 0,
					"address": "4103804705971278554L",
					"publicKey": "f834a69d7f017b649859ea85f0a0c649202a8fb4619afa96daed06fa5641746b",
					"balance": 5000000000,
					"vote": "0",
					"multimin": 0,
					"multilifetime": 0,
					"nameexist": 0,
					"producedBlocks": 0,
					"missedBlocks": 0,
					"fees": "0",
					"rewards": "0",
					"asset": {},
					"voteWeight": "1000000000000",
					"secondPublicKey": "62e4d09ce3fa571fb4b073fb229f5ff18b6108ca89357924db887a409f61542c"
				}
			]
		},
		"input": {
			"blockWithNewSecondSignatureNewRegistration": {
				"version": 1,
				"totalAmount": "0",
				"totalFee": "500000000",
				"reward": "0",
				"timestamp": 20,
				"numberOfTransactions": 1,
				"payloadLength": 149,
				"generatorPublicKey": "f834a69d7f017b649859ea85f0a0c649202a8fb4619afa96daed06fa5641746b",
				"transactions": [
					{
						"id": "3613932868772923380",
						"amount": "0",
						"type": 1,
						"timestamp": 102702700,
						"senderPublicKey": "f834a69d7f017b649859ea85f0a0c649202a8fb4619afa96daed06fa5641746b",
						"senderId": "4103804705971278554L",
						"recipientId": "",
						"fee": "500000000",
						"signature": "abd99fb3c9f1140f7db4cf73b960c20efab2df047b040807132cb5d899a9748c1d7853bae571af781025f4e3d7132fd02ece01e163e900533d57da094b5a200c",
						"signatures": [],
						"asset": {
							"signature": {
								"publicKey": "62e4d09ce3fa571fb4b073fb229f5ff18b6108ca89357924db887a409f61542c"
							}
						}
					}
				],
				"payloadHash": "f48751f5cb4427328c126f60da342b8a635b8e56aa6a385c6cf0a4772ce400e8",
				"blockSignature": "ff23fe8f300ad394328178dbbbb866a6d52c5dda9f32405e518cdab92f8f807aa832224e5a26db7c723996b01f8db213befeab4c1077b1a43f1a1ade3cca370d",
				"height": 3
			}
		},
		"output": {
			"chain": [
				{
					"version": 1,
					"totalAmount": "5500000000",
					"totalFee": "10000000",
					"reward": "0",
					"timestamp": 10,
					"numberOfTransactions": 1,
					"payloadLength": 117,
					"previousBlock": "3110763447174287315",
					"generatorPublicKey": "f834a69d7f017b649859ea85f0a0c649202a8fb4619afa96daed06fa5641746b",
					"transactions": [
						{
							"id": "18302556673844952853",
							"amount": "5500000000",
							"type": 0,
							"timestamp": 102702700,
							"senderPublicKey": "0b3dc5a506e312bac462afc4fb34cdc3b19d1976a279930d15ae3c3516edd188",
							"senderId": "12451387766827060593L",
							"recipientId": "4103804705971278554L",
							"fee": "10000000",
							"signature": "3a4912e95376821f6739c71e58fe10e69f3492460228233f9e84b017fa2b7f4296cb975f8f431b8b2e7fdf23d074825044dcaadd28c2c2633a3e475e1a27640f",
							"signatures": [],
							"asset": {}
						}
					],
					"payloadHash": "15bffbe152befffdc87fe0ca16ba40fe12be4ed91dbebaeb21315bcf5e4fe087",
					"blockSignature": "41c969589a7fb7e99f17bb60490bbb792a1eabdeba2185306c873210697b58acb452789dcfa7dd5a919b887b58d75b77c3ee9aa838365f1ef9d2d2e9fce66b0e",
					"height": 2
				},
				{
					"version": 1,
					"totalAmount": "0",
					"totalFee": "500000000",
					"reward": "0",
					"timestamp": 20,
					"numberOfTransactions": 1,
					"payloadLength": 149,
					"generatorPublicKey": "f834a69d7f017b649859ea85f0a0c649202a8fb4619afa96daed06fa5641746b",
					"transactions": [
						{
							"id": "3613932868772923380",
							"amount": "0",
							"type": 1,
							"timestamp": 102702700,
							"senderPublicKey": "f834a69d7f017b649859ea85f0a0c649202a8fb4619afa96daed06fa5641746b",
							"senderId": "4103804705971278554L",
							"recipientId": "",
							"fee": "500000000",
							"signature": "abd99fb3c9f1140f7db4cf73b960c20efab2df047b040807132cb5d899a9748c1d7853bae571af781025f4e3d7132fd02ece01e163e900533d57da094b5a200c",
							"signatures": [],
							"asset": {
								"signature": {
									"publicKey": "62e4d09ce3fa571fb4b073fb229f5ff18b6108ca89357924db887a409f61542c"
								}
							}
						}
					],
					"payloadHash": "f48751f5cb4427328c126f60da342b8a635b8e56aa6a385c6cf0a4772ce400e8",
					"blockSignature": "ff23fe8f300ad394328178dbbbb866a6d52c5dda9f32405e518cdab92f8f807aa832224e5a26db7c723996b01f8db213befeab4c1077b1a43f1a1ade3cca370d",
					"height": 3
				}
			],
			"accounts": [
				{
					"address": "12451387766827060593L",
					"publicKey": "0b3dc5a506e312bac462afc4fb34cdc3b19d1976a279930d15ae3c3516edd188",
					"balance": 994500000000,
					"secondSignature": 0,
					"isDelegate": 0,
					"vote": "0",
					"multimin": 0,
					"multilifetime": 0,
					"nameexist": 0,
					"producedBlocks": 0,
					"missedBlocks": 0,
					"fees": "0",
					"rewards": "0",
					"asset": {},
					"voteWeight": "0"
				},
				{
					"username": "genesis_100",
					"isDelegate": 1,
					"secondSignature": 0,
					"address": "4103804705971278554L",
					"publicKey": "f834a69d7f017b649859ea85f0a0c649202a8fb4619afa96daed06fa5641746b",
					"balance": 5000000000,
					"vote": "0",
					"multimin": 0,
					"multilifetime": 0,
					"nameexist": 0,
					"producedBlocks": 0,
					"missedBlocks": 0,
					"fees": "0",
					"rewards": "0",
					"asset": {},
					"voteWeight": "1000000000000",
					"secondPublicKey": "62e4d09ce3fa571fb4b073fb229f5ff18b6108ca89357924db887a409f61542c"
				}
			]
		}
	}
}
